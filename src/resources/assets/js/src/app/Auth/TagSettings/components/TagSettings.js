"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_BatchsGraph=require("../../../../Graph/BatchsGraph"),_redexConnect=require("../../../../../../../../../../ruf/src/resources/assets/js/src/utils/redex-connect"),_redexConnect2=_interopRequireDefault(_redexConnect),TagSettings=function(e){function t(e,a){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a));return r.state={error:"",sending:!1,multipleTags:!1},r.store=r.context.store,r.store.dispatch({type:"setState",state:{rufTagSettings:{}}}),r}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){var e=this;(0,_BatchsGraph.getBatchs)().then(function(){e.store.dispatch({type:"setState",state:{rufTagSettings:{loaded:!0}}})})}},{key:"saveBatch",value:function(){for(var e=this.refs.selections.value.split(/\n/),t=0;t<e.length;t++)e[t]=e[t].replace(",","");e=e.join(","),(0,_BatchsGraph.addBatch)({name:this.refs.name.value,taggable_type:this.refs.taggable_type.value,multi:this.refs.multi.checked,selections:e})}},{key:"render",value:function(){return this.props.localState.rufTagSettings.loaded?_react2.default.createElement("div",null,this.state.error?_react2.default.createElement("div",{className:"text-xs-center alert alert-danger"},this.state.error):"",_react2.default.createElement("div",{className:"row form-group"},_react2.default.createElement("label",{className:"col-md-4 col-form-label"},"Name of the tag"),_react2.default.createElement("div",{className:"col-md-8"},_react2.default.createElement("input",{ref:"name",className:"form-control",type:"text"})),_react2.default.createElement("label",{className:"col-md-4 col-form-label"},"What would you like to tag?"),_react2.default.createElement("div",{className:"col-md-8"},_react2.default.createElement("select",{ref:"taggable_type",disabled:this.state.sending,className:"form-control"},this.props.tagBatchNames.map(function(e){return _react2.default.createElement("option",{value:e.slug,key:e.slug},e.name)}))),_react2.default.createElement("label",{className:"col-md-4 col-form-label"},"Allow multiple tags?"),_react2.default.createElement("div",{className:"col-md-8"},_react2.default.createElement("input",{ref:"multi",className:"",style:{height:"40px"},type:"checkbox",value:"1"})),_react2.default.createElement("label",{className:"col-md-4 col-form-label"},"What are the tags?"),_react2.default.createElement("div",{className:"col-md-8"},_react2.default.createElement("textarea",{className:"form-control",ref:"selections",rows:"5"})),_react2.default.createElement("div",{className:"col-md-8 offset-md-4 m-t-1"},_react2.default.createElement("button",{className:"btn btn-primary",onClick:this.saveBatch.bind(this)},"Save")))):_react2.default.createElement("div",{className:"text-xs-center"},_react2.default.createElement("div",{className:"fa fa-3x fa-cog fa-spin"}))}}]),t}(_react2.default.Component);module.exports=(0,_redexConnect2.default)(TagSettings,{tagBatchs:"tagBatchs",tagBatchNames:"tagBatchNames",localState:"localState"});